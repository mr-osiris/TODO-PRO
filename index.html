<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo PRO</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .add-task-form {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .form-row .form-group {
            flex: 1;
            min-width: 200px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        input[type="text"], input[type="datetime-local"], select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus, input[type="datetime-local"]:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn-edit {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            color: #2d3436;
        }

        .btn-delete {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%);
        }

        .tasks-container {
            padding: 30px;
        }

        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .filter-tab {
            padding: 10px 20px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .filter-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .task-item {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .task-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .task-item.completed {
            opacity: 0.7;
            background: #f8f9fa;
        }

        .task-item.completed .task-title {
            text-decoration: line-through;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .task-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 5px;
        }

        .task-meta {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .priority-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-high {
            background: #ff6b6b;
            color: white;
        }

        .priority-medium {
            background: #feca57;
            color: #2d3436;
        }

        .priority-low {
            background: #48dbfb;
            color: #2d3436;
        }

        .deadline-info {
            font-size: 14px;
            color: #6c757d;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .deadline-warning {
            color: #e17055;
            font-weight: 600;
        }

        .deadline-overdue {
            color: #d63031;
            font-weight: 600;
        }

        .task-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-container input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .edit-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #48dbfb;
            color: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .priority-indicator {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
        }

        .priority-indicator.high {
            background: #ff6b6b;
        }

        .priority-indicator.medium {
            background: #feca57;
        }

        .priority-indicator.low {
            background: #48dbfb;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .form-row .form-group {
                min-width: auto;
            }
            
            .task-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .task-actions {
                justify-content: center;
            }
            
            .filter-tabs {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✨ Advanced Todo App</h1>
            <p>Organize your tasks with style and efficiency</p>
        </div>

        <div class="add-task-form">
            <form id="taskForm">
                <div class="form-group">
                    <label for="taskTitle">Task Title</label>
                    <input type="text" id="taskTitle" placeholder="Enter your task..." required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="taskPriority">Priority</label>
                        <select id="taskPriority">
                            <option value="low">Low Priority</option>
                            <option value="medium" selected>Medium Priority</option>
                            <option value="high">High Priority</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskDeadline">Deadline (Optional)</label>
                        <input type="datetime-local" id="taskDeadline">
                    </div>
                </div>
                
                <button type="submit" class="btn">
                    <span>➕</span> Add Task
                </button>
            </form>
        </div>

        <div class="tasks-container">
            <div class="filter-tabs">
                <div class="filter-tab active" data-filter="all">All Tasks</div>
                <div class="filter-tab" data-filter="active">Active</div>
                <div class="filter-tab" data-filter="completed">Completed</div>
                <div class="filter-tab" data-filter="high">High Priority</div>
            </div>

            <div id="tasksList"></div>
        </div>
    </div>

    <script>
        class TodoApp {
            constructor() {
                this.tasks = [];
                this.currentFilter = 'all';
                this.editingTask = null;
                this.reminderTimeouts = new Map();
                
                this.init();
            }

            init() {
                this.loadTasks();
                this.bindEvents();
                this.renderTasks();
                this.checkDeadlines();
                
                // Check deadlines every minute
                setInterval(() => this.checkDeadlines(), 60000);
            }

            bindEvents() {
                document.getElementById('taskForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addTask();
                });

                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.setFilter(e.target.dataset.filter);
                    });
                });
            }

            addTask() {
                const title = document.getElementById('taskTitle').value.trim();
                const priority = document.getElementById('taskPriority').value;
                const deadline = document.getElementById('taskDeadline').value;

                if (!title) return;

                const task = {
                    id: Date.now().toString(),
                    title,
                    priority,
                    deadline: deadline || null,
                    completed: false,
                    createdAt: new Date().toISOString()
                };

                this.tasks.push(task);
                this.saveTasks();
                this.renderTasks();
                this.clearForm();
                this.showNotification('Task added successfully! ✅');
                
                if (deadline) {
                    this.setDeadlineReminder(task);
                }
            }

            editTask(taskId) {
                const task = this.tasks.find(t => t.id === taskId);
                if (!task) return;

                this.editingTask = taskId;
                this.renderTasks();
            }

            updateTask(taskId) {
                const task = this.tasks.find(t => t.id === taskId);
                if (!task) return;

                const titleInput = document.querySelector(`#edit-title-${taskId}`);
                const priorityInput = document.querySelector(`#edit-priority-${taskId}`);
                const deadlineInput = document.querySelector(`#edit-deadline-${taskId}`);

                task.title = titleInput.value.trim();
                task.priority = priorityInput.value;
                task.deadline = deadlineInput.value || null;

                this.editingTask = null;
                this.saveTasks();
                this.renderTasks();
                this.showNotification('Task updated successfully! ✏️');
                
                if (task.deadline) {
                    this.setDeadlineReminder(task);
                }
            }

            deleteTask(taskId) {
                if (confirm('Are you sure you want to delete this task?')) {
                    this.tasks = this.tasks.filter(t => t.id !== taskId);
                    this.clearDeadlineReminder(taskId);
                    this.saveTasks();
                    this.renderTasks();
                    this.showNotification('Task deleted successfully! 🗑️');
                }
            }

            toggleTask(taskId) {
                const task = this.tasks.find(t => t.id === taskId);
                if (!task) return;

                task.completed = !task.completed;
                this.saveTasks();
                this.renderTasks();
                
                if (task.completed) {
                    this.clearDeadlineReminder(taskId);
                    this.showNotification('Task completed! 🎉');
                } else {
                    this.showNotification('Task reopened! 🔄');
                    if (task.deadline) {
                        this.setDeadlineReminder(task);
                    }
                }
            }

            setFilter(filter) {
                this.currentFilter = filter;
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
                this.renderTasks();
            }

            getFilteredTasks() {
                switch (this.currentFilter) {
                    case 'active':
                        return this.tasks.filter(task => !task.completed);
                    case 'completed':
                        return this.tasks.filter(task => task.completed);
                    case 'high':
                        return this.tasks.filter(task => task.priority === 'high');
                    default:
                        return this.tasks;
                }
            }

            renderTasks() {
                const tasksList = document.getElementById('tasksList');
                const filteredTasks = this.getFilteredTasks();
                
                // Sort tasks by priority and deadline
                filteredTasks.sort((a, b) => {
                    const priorityOrder = { high: 3, medium: 2, low: 1 };
                    
                    if (a.priority !== b.priority) {
                        return priorityOrder[b.priority] - priorityOrder[a.priority];
                    }
                    
                    if (a.deadline && b.deadline) {
                        return new Date(a.deadline) - new Date(b.deadline);
                    }
                    
                    if (a.deadline && !b.deadline) return -1;
                    if (!a.deadline && b.deadline) return 1;
                    
                    return new Date(b.createdAt) - new Date(a.createdAt);
                });

                if (filteredTasks.length === 0) {
                    tasksList.innerHTML = `
                        <div class="empty-state">
                            <h3>No tasks found</h3>
                            <p>Add a new task to get started!</p>
                        </div>
                    `;
                    return;
                }

                tasksList.innerHTML = filteredTasks.map(task => this.renderTask(task)).join('');
            }

            renderTask(task) {
                const deadlineInfo = this.getDeadlineInfo(task);
                const isEditing = this.editingTask === task.id;

                return `
                    <div class="task-item ${task.completed ? 'completed' : ''}">
                        <div class="priority-indicator ${task.priority}"></div>
                        
                        ${!isEditing ? `
                            <div class="checkbox-container">
                                <input type="checkbox" ${task.completed ? 'checked' : ''} 
                                       onchange="todoApp.toggleTask('${task.id}')">
                                <span class="task-title">${task.title}</span>
                            </div>
                            
                            <div class="task-header">
                                <div class="task-meta">
                                    <span class="priority-badge priority-${task.priority}">${task.priority}</span>
                                    ${deadlineInfo.html}
                                </div>
                                
                                <div class="task-actions">
                                    <button class="btn btn-small btn-edit" onclick="todoApp.editTask('${task.id}')">
                                        ✏️ Edit
                                    </button>
                                    <button class="btn btn-small btn-delete" onclick="todoApp.deleteTask('${task.id}')">
                                        🗑️ Delete
                                    </button>
                                </div>
                            </div>
                        ` : `
                            <div class="edit-form">
                                <div class="form-group">
                                    <label>Task Title</label>
                                    <input type="text" id="edit-title-${task.id}" value="${task.title}">
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Priority</label>
                                        <select id="edit-priority-${task.id}">
                                            <option value="low" ${task.priority === 'low' ? 'selected' : ''}>Low</option>
                                            <option value="medium" ${task.priority === 'medium' ? 'selected' : ''}>Medium</option>
                                            <option value="high" ${task.priority === 'high' ? 'selected' : ''}>High</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Deadline</label>
                                        <input type="datetime-local" id="edit-deadline-${task.id}" 
                                               value="${task.deadline || ''}">
                                    </div>
                                </div>
                                
                                <div class="task-actions">
                                    <button class="btn btn-small" onclick="todoApp.updateTask('${task.id}')">
                                        ✅ Save
                                    </button>
                                    <button class="btn btn-small btn-delete" onclick="todoApp.editingTask = null; todoApp.renderTasks();">
                                        ❌ Cancel
                                    </button>
                                </div>
                            </div>
                        `}
                    </div>
                `;
            }

            getDeadlineInfo(task) {
                if (!task.deadline) {
                    return { html: '', isOverdue: false, isWarning: false };
                }

                const deadline = new Date(task.deadline);
                const now = new Date();
                const timeDiff = deadline - now;
                const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));

                let className = 'deadline-info';
                let text = `📅 Due: ${deadline.toLocaleDateString()} ${deadline.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;

                if (timeDiff < 0) {
                    className += ' deadline-overdue';
                    text = `⚠️ Overdue: ${Math.abs(daysDiff)} days ago`;
                } else if (daysDiff <= 1) {
                    className += ' deadline-warning';
                    text = `⏰ Due soon: ${deadline.toLocaleDateString()} ${deadline.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`;
                }

                return {
                    html: `<span class="${className}">${text}</span>`,
                    isOverdue: timeDiff < 0,
                    isWarning: daysDiff <= 1 && timeDiff >= 0
                };
            }

            setDeadlineReminder(task) {
                if (!task.deadline || task.completed) return;

                const deadline = new Date(task.deadline);
                const now = new Date();
                const reminderTime = deadline - now - (24 * 60 * 60 * 1000); // 24 hours before

                if (reminderTime > 0) {
                    const timeoutId = setTimeout(() => {
                        this.showNotification(`⏰ Reminder: "${task.title}" is due tomorrow!`);
                    }, reminderTime);

                    this.reminderTimeouts.set(task.id, timeoutId);
                }
            }

            clearDeadlineReminder(taskId) {
                if (this.reminderTimeouts.has(taskId)) {
                    clearTimeout(this.reminderTimeouts.get(taskId));
                    this.reminderTimeouts.delete(taskId);
                }
            }

            checkDeadlines() {
                this.tasks.forEach(task => {
                    if (!task.deadline || task.completed) return;

                    const deadline = new Date(task.deadline);
                    const now = new Date();
                    const timeDiff = deadline - now;
                    const hoursDiff = timeDiff / (1000 * 60 * 60);

                    // Show notification for tasks due within 1 hour
                    if (hoursDiff <= 1 && hoursDiff > 0) {
                        this.showNotification(`🚨 URGENT: "${task.title}" is due in less than 1 hour!`);
                    }
                });
            }

            clearForm() {
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskPriority').value = 'medium';
                document.getElementById('taskDeadline').value = '';
            }

            showNotification(message) {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }

            saveTasks() {
                localStorage.setItem('todoTasks', JSON.stringify(this.tasks));
            }

            loadTasks() {
                const saved = localStorage.getItem('todoTasks');
                if (saved) {
                    this.tasks = JSON.parse(saved);
                    // Re-set deadline reminders for loaded tasks
                    this.tasks.forEach(task => {
                        if (task.deadline && !task.completed) {
                            this.setDeadlineReminder(task);
                        }
                    });
                } else {
                    this.tasks = [];
                }
            }
        }

        // Initialize the app
        const todoApp = new TodoApp();
    </script>
</body>
</html>
